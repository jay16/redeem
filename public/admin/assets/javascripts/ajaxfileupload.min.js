jQuery.extend({handleError:function(e,t,r,o){e.error&&e.error.call(e.context||e,t,r,o),e.global&&(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,o])},createUploadIframe:function(e,t){var r="jUploadFrame"+e;if(window.ActiveXObject){if("9.0"==jQuery.browser.version)o=document.createElement("iframe"),o.id=r,o.name=r;else if("6.0"==jQuery.browser.version||"7.0"==jQuery.browser.version||"8.0"==jQuery.browser.version){var o=document.createElement('<iframe id="'+r+'" name="'+r+'" />');"boolean"==typeof t?o.src="javascript:false":"string"==typeof t&&(o.src=t)}}else{var o=document.createElement("iframe");o.id=r,o.name=r}return o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",document.body.appendChild(o),o},ajaxUpload:function(s,xml){var uid=(new Date).getTime(),idIO="jUploadFrame"+uid,_this=this,jIO=$('<iframe name="'+idIO+'" id="'+idIO+'" style="display:none">').appendTo("body"),jForm=$('<form action="'+s.url+'" target="'+idIO+'" method="post" enctype="multipart/form-data"></form>').appendTo("body"),oldElement=$("#"+s.fileElementId),newElement=$(oldElement).clone(true);return $(oldElement).attr("id","jUploadFile"+uid),$(oldElement).before(newElement),$(oldElement).appendTo(jForm),this.remove=function(){null!==_this&&(jNewFile.before(jOldFile).remove(),jIO.remove(),jForm.remove(),_this=null)},this.onLoad=function(){var data=$(jIO[0].contentWindow.document.body).text();try{if(void 0!=data){data=eval("("+data+")");try{s.success&&s.success(data,status),s.global&&jQuery.event.trigger("ajaxSuccess",[xml,s]),s.complete&&s.complete(data,status),xml=null}catch(e){status="error",jQuery.handleError(s,xml,status,e)}s.global&&jQuery.event.trigger("ajaxComplete",[xml,s]),s.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop")}}catch(ex){alert(ex.message)}},this.start=function(){jForm.submit(),jIO.load(_this.onLoad)},this},createUploadForm:function(e,t,r,o){var a="jUploadForm"+e,n="jUploadFile"+e,u=jQuery('<form  action="'+t+'" method="POST" name="'+a+'" id="'+a+'" enctype="multipart/form-data"></form>');if(o)for(var l in o)jQuery('<input type="hidden" name="'+l+'" value="'+o[l]+'" />').appendTo(u);var d=jQuery("#"+r),i=jQuery(d).clone();return jQuery(d).attr("id",n),jQuery(d).before(i),jQuery(d).appendTo(u),jQuery(u).css("position","absolute"),jQuery(u).css("top","-1200px"),jQuery(u).css("left","-1200px"),jQuery(u).appendTo("body"),u},ajaxFileUpload:function(e){var t={};if(e=jQuery.extend({},jQuery.ajaxSettings,e),!window.ActiveXObject){var r=(new Date).getTime(),o=jQuery.createUploadForm(r,e.url,e.fileElementId,"undefined"==typeof e.data?!1:e.data),a=(jQuery.createUploadIframe(r,e.secureuri),"jUploadFrame"+r),n="jUploadForm"+r;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var u=!1;e.global&&jQuery.event.trigger("ajaxSend",[t,e]);var l=function(r){var n=document.getElementById(a);try{n.contentWindow?(t.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerHTML:null,t.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document):n.contentDocument&&(t.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerHTML:null,t.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document)}catch(l){jQuery.handleError(e,t,null,l)}if(t||"timeout"==r){u=!0;var d;try{if(d="timeout"!=r?"success":"error","error"!=d){var i=jQuery.uploadHttpData(t,e.dataType);e.success&&e.success(i,d),e.global&&jQuery.event.trigger("ajaxSuccess",[t,e]),e.complete&&e.complete(i,d)}else jQuery.handleError(e,t,d)}catch(l){d="error",jQuery.handleError(e,t,d,l)}e.global&&jQuery.event.trigger("ajaxComplete",[t,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),jQuery(n).unbind(),setTimeout(function(){try{jQuery(n).remove(),jQuery(o).remove()}catch(r){jQuery.handleError(e,t,null,r)}},100),t=null}};e.timeout>0&&setTimeout(function(){u||l("timeout")},e.timeout);try{var o=jQuery("#"+n);jQuery(o).attr("action",e.url),jQuery(o).attr("method","POST"),jQuery(o).attr("target",a),o.encoding?jQuery(o).attr("encoding","multipart/form-data"):jQuery(o).attr("enctype","multipart/form-data"),jQuery(o).submit()}catch(d){jQuery.handleError(e,t,null,d)}return jQuery("#"+a).load(l),{abort:function(){}}}var i=new jQuery.ajaxUpload(e,t);i.start()},uploadHttpData:function(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+$(data).html()),"html"==type&&jQuery("<div>").html(data).evalScripts(),data}});