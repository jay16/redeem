<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta http-equiv="refresh" content="3540"> <!-- refresh page every 59 minutes -->
<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="renderer" content="webkit">
<title>客户信息 - 礼品兑换</title>
<link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<link media="all" type="text/css" rel="stylesheet" href="assets/stylesheets/public-style.css?timestamp=1501089370">
<link media="all" type="text/css" rel="stylesheet" href="assets/stylesheets/animate.min.css?timestamp=1501089370">
<link media="all" type="text/css" rel="stylesheet" href="assets/stylesheets/side.css?timestamp=1501089370">
<link media="all" type="text/css" rel="stylesheet" href="assets/stylesheets/tc.css?timestamp=1501089370">
<link media="all" type="text/css" rel="stylesheet" href="assets/stylesheets/search.css?timestamp=1501089370">
<script src="assets/javascripts/remJs.js?timestamp=1501089370"></script>
<script src="assets/javascripts/jquery-1.12.4.js?timestamp=1501089370"></script>
<script src="assets/javascripts/plugins/layer/layer.js?timestamp=1501089370"></script>
<script src="assets/javascripts/server_api.js?timestamp=1501089370"></script>
<script src="assets/javascripts/tkh.js?timestamp=1501089370"></script>
</head>
<body>
<div id="jiaZai">
  <img src="assets/images/loadbg.png?timestamp=1501089370">
</div>

<script src="assets/javascripts/distpicker.data.js?timestamp=1501089370"></script>
<script src="assets/javascripts/distpicker.js?timestamp=1501089370"></script>
<script src="assets/javascripts/mobiscroll.custom-2.17.1.min.js?timestamp=1501089370"></script>
<link type="text/css" rel="stylesheet" href="assets/stylesheets/mobiscroll.custom-2.17.1.min.css?timestamp=1501089370">
<style>
#layui-layer1{ top:223px !important; }
.tishibuton .cs { margin: 0.5rem !important; }
.tishibuton .button { margin: 0.5rem !important; }
.hidden { display: none; }
</style>
<div id="main">
  <div class="title">
    <div>
      <img src="assets/images/dhlp2.png?timestamp=1501089370">礼品兑换 -
      <img src="assets/images/renWu2.png?timestamp=1501089370">客户信息
    </div>
    <div>Gift Redemption - Customer</div>
  </div>
  <div class="prompt">
    请输入手机号码 / Mobile phone number:
  </div>
  <div class="search">
    <form action="javascript: window.TKH.queryMemberInfoJSON();">
      <input type="tel" id="search" placeholder="手机号码 / Mobile phone number" value="" />
      <a href="javascript:void(0)" onClick="window.TKH.queryMemberInfoJSON();" id="btn_search">
        <img src="assets/images/search.png?timestamp=1501089370">
      </a>
    </form>
  </div>
  <div class="content">
    <div class="content_1">
      <div class="act" data-id="1">
        <p>顾客信息 / Customer</p>
        <p>Information</p>
      </div>
      <div data-id="2" class='score-information'>
        <p>积分信息 / Points</p>
        <p>Records</p>
      </div>
      <div data-id="3" class='redeem-history'>
        <p>兑换记录 / Redeem</p>
        <p>History</p>
      </div>
    </div>
    <div class="content_2">
      <div data-id='1' style="display: block;">
        <div style="width: 90%;display:block;">
          <p>姓名 / Full name</p>
          <input type="text" id="mz" value="" style="width:50%;" />
        </div>
        <div style="max-width: 45%;">
          <p>性别 / Gender</p>
          <select name="" id="xb">
            <option value="男" selected>男 / M</option>
            <option value="女">女 / F</option></select>
        </div>
        <div>
          <p>出生日期 / Birthday</p>
          <input type="text" name="birthday" id="birthday" autocomplete="off" readonly />
        </div>
        <div class="dz" style="display:inline;width: 45%!important">
          <p>居住地址 / Live Address</p>

          <input class='hidden' type="text" name="liveaddress" id="live_dz_text" readonly />
          <form class="form-inline" id='live_dz_distpicker_wrapper'>
            <div id="live_dz_distpicker">
              <div class="form-group">
                <label class="sr-only" for="ldd_province">选择省</label>
                <select class="form-control" id="ldd_province"></select>
              </div>
              <div class="form-group">
                <label class="sr-only" for="ldd_city">选择市</label>
                <select class="form-control" id="ldd_city"></select>
              </div>
              <div class="form-group">
                <label class="sr-only" for="ldd_district">选择区</label>
                <select class="form-control" id="ldd_district"></select>
              </div>
            </div>
          </form>
        </div>
        <div class="dz" style="display:inline;width: 45%!important">
          <p>工作地址 / Work Address</p>

          <input class='hidden' type="text" name="workaddress" id="work_dz_text" readonly />
          <form class="form-inline" id='work_dz_distpicker_wrapper'>
            <div id="work_dz_distpicker">
              <div class="form-group">
                <label class="sr-only" for="wdd_province">选择省</label>
                <select class="form-control" id="wdd_province"></select>
              </div>
              <div class="form-group">
                <label class="sr-only" for="wdd_city">选择市</label>
                <select class="form-control" id="wdd_city"></select>
              </div>
              <div class="form-group">
                <label class="sr-only" for="wdd_district">选择区</label>
                <select class="form-control" id="wdd_district"></select>
              </div>
            </div>
          </form>
        </div>
        <div class="dz legal-provision-dz">
          <p>
            <input id='checkbox_legal' type="checkbox" checked="checked" style="width: 0.4rem;" />
            同意并愿意遵守兴业太古汇
            <a class="legal-provision-link" href="javascript:void(0);">会员计划章程及细则</a>
          </p>
        </div>
      </div>
      <div data-id="2" id="ScoreInfo">
        <div style="width: 45%;">
          <div style="display: block;width: 90%;margin: 0 20%;margin-bottom: 15px;">
            <p style="display: inline-block;">姓&nbsp;&nbsp;名: </p>
            <input disabled="disabled" style="width: 80%;" type="text" class="score-field member-name" value="" />
          </div>
          <div style="display: block;width: 90%;margin: 0 20%;margin-bottom: 15px;">
            <p style="display: inline-block;">会员号: </p>
            <input disabled="disabled" style="width: 80%;" type="text" class="score-field member-card-number" value="" />
          </div>
          <div style="display: block;width: 90%;margin: 0 20%;margin-bottom: 15px;">
            <p style="display: inline-block;">总积分: </p>
            <input disabled="disabled" style="width: 80%;" type="text" class='score-field member-score' value="" />
          </div>
        </div>
        <div style="width: 45%;">
        </div>
      </div>
      <div data-id="3" id="ExchangeInfo">
        <div style="width: 45%;">
        </div>
        <div style="width: 45%;">
        </div>
      </div>
    </div>
  </div>
  <div class="anNiu">
    <a href="javascript:void(0);" class="bc btn-save" onclick="window.TKH.openCardJson();">保存
      <br/>Save
    </a>
    <a href="javascript:void(0);" class="xy btn-next" style="display:block">下一页
      <br/>Next</a>
  </div>
</div>
<div class="tishibuton-area" style="display:none;">
  <div style="min-height:120px; text-align:center; font-size:16px; line-height:30px; background: #333; color:lightgray;padding-top:20px;">
    <p class="">是否只做问卷，不添加消费信息、兑换信息等？</p>
    <div style="margin: 0 auto;margin-top:20px;">
    <a href="javascript:void(0);" onclick="window.TKH.redirect_to_with_timestamp('score-input.html');" class="button score-input" style='display: none;margin-right:20px'>消费积分</a>
    <a style="margin-right:20px"  href="javascript:void(0);" onclick="window.TKH.redirect_to_with_timestamp('entry.html?from=search.html');" class="button">消费兑换</a>
    <a href="javascript:void(0);" onclick="window.TKH.redirect_to_with_timestamp('questionnaire.html?skip_signature=1');" class="button">填写问卷</a>
  </div>
  </div>
</div>
<div class="regisitered-area" style="display:none;">
  <div style="text-align:center; font-size:14px; line-height:30px; background: #333; color:lightgray;padding-bottom:20px;">
    <p style="">注册成功，卡号：
      <span id="fnum_span" style="color: white;font-size:18px">123123</span>
    </p>

    <p class="sm">请扫描二维码, 同步在微信端绑定会员卡 </p>
    <p class="sm"><img src="assets/images/ewm.png?timestamp=1501089370" style="max-width:200px; max-height: 200px;" /></p>
  </div>
</div>
<div class="gn">
  <div class="dj">
    <div>
      <img src="assets/images/gn1.png?timestamp=1501089370" class="xs" alt="">
      <img src="assets/images/gn2.png?timestamp=1501089370" class="yc" alt="">
    </div>
    <div style="display:none;">
      <img src="assets/images/gn2.png?timestamp=1501089370">
    </div>
  </div>
  <div class="nr">
    <div>礼品兑换系统</div>
    <p class="lp">
      <a href="search.html">
        <img src="assets/images/dhlp.png?timestamp=1501089370">礼品兑换</a></p>
    <p class="mm">
      <img src="assets/images/bi.png?timestamp=1501089370" class="bi" alt="">修改密码</p>
    <p class="tuichu" onClick="window.TKH.logout();">
      <img src="assets/images/dl2.png?timestamp=1501089370">退出登录</p>
    <div class="renWu">
      <img src="assets/images/renWu.png?timestamp=1501089370">
      <p id="userGid"></p>
      <p class="time">123</p>
    </div>
  </div>
</div>
<div class="xg">
  <div>
    <a href="javascript:void(0);" class="gb">
      <img src="assets/images/gb.png?timestamp=1501089370"></a>
    <div class="xg_content">
      <div class="suo">
        <img src="assets/images/bi.png?timestamp=1501089370"></div>
      <div class="xg_info">
        <p class="title">修改密码</p>
        <input type="password" id="oldPassword" placeholder="旧密码" />
        <input type="password" id="newPassword" placeholder="新密码" />
        <input type="password" id="rePassword" placeholder="再次输入新密码" />
        <a onclick='window.ServerAPI.resetPassword();' href="javascript:void(0);" class="cs mima">确认修改密码</a></div>
    </div>
  </div>
</div>
<script>
$(function() {
  // 清除已查询用户信息
  window.localStorage.removeItem("sFCARDNUM");
  window.localStorage.removeItem("current_telphone");
  // 清除已录入消费信息
  window.localStorage.removeItem("records");
  // 消除问卷信息
  window.localStorage.removeItem("questionnaire");
  // 清除问卷回答信息
  window.localStorage.removeItem("questionnaire_state");

  // 地址控件
  $('#live_dz_distpicker,#work_dz_distpicker').distpicker({autoSelect: false});
  // 日期控件
  var opt = {
      preset: 'date', //日期
      theme: 'ios', //皮肤样式
      display: 'bubble', //显示方式
      mode: 'scroller', //日期选择模式
      dateFormat: 'yy-mm-dd', // 日期格式
      setText: '确定', //确认按钮名称
      cancelText: '取消',//取消按钮名籍我
      dateOrder: 'yymmdd', //面板中日期排列格式
      dayText: '日', monthText: '月', yearText: '年', //面板中年月日文字
      maxDate: (new Date())
  };
  $("#birthday").mobiscroll(opt).date(opt);
  $('#birthday').mobiscroll('setDate', (new Date(1970, 0, 1, 0, 0, 0, 0)), false);

  $("#checkbox_legal").change(function() {
      if(this.checked) {
        $(".btn-save").removeClass("xy").addClass("bc").html("保存<br>Save");
      } else {
        $(".btn-save").removeClass("bc").addClass("xy").html("下一步<br>Next");
      }
  });
  // 全员章程
  $(".legal-provision-link").click(function(e) {
    e.stopPropagation();

    layer.open({
      type: 2,
      offset: '50px',
      title: '会员计划章程及细则',
      area: ['500px', '600px'],
      content: 'legal-provision.html',
      success: function(layero){
        layer.setTop(layero);
      }
    });
  });
  //顾客信息记录选择
  $('.content_1 > div').click(function(e) {
    e.stopPropagation();

      if(!$(this).hasClass('act')){
        $('.content_1 .act').removeClass('act');
        $(this).addClass('act');
        $('.content_2 > div').hide();
        $('.content_2 > div:eq('+$(this).index()+')').show();
      }

      var sFCardNum = window.localStorage.getItem('sFCARDNUM');
      if($(this).hasClass("score-information")) {
        if(sFCardNum !== null) {
          var userJSONstr = window.localStorage.getItem("current_telphone");

          if(userJSONstr) {
            var userJSON = JSON.parse(userJSONstr);
            $("#ScoreInfo .member-name").val(userJSON["name"]);
            $("#ScoreInfo .member-card-number").val(userJSON["card_number"]);
            $("#ScoreInfo .member-score").val(userJSON["total_score"]);
            if(!$("#ScoreInfo .member-score").val().length) {
              $("#ScoreInfo .member-score").val("0");
            }

            window.TKH.queryCardScoreDetails();
          }
        }
      }

      if($(this).hasClass("redeem-history")) {
        if(sFCardNum !== null) {
          window.TKH.queryLAGSupplyInfo();
        }
      }
  })

  //下一页
  $('.xy').on('click',function(e) {
    e.stopPropagation();

      var card_number = window.localStorage.getItem('sFCARDNUM');
      if(card_number === null) {
        layer.msg('请『搜索』会员信息',{time: 2000});
        return false;
      }
      var phone = $('#search').val();
      var name =  $('#mz').val();
      if (!phone || !name) {
          layer.tips('请输入手机号码,查询用户或新增用户！', '#search', {
            tips: [3, '#faab20']
          });
          return false;
      }
      var $phe=/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/;
      if(!($phe.test(phone))){
        layer.msg('请输入正确的手机号码',{time: 2000});
        return false;
      }

      if(card_number && !isNaN(card_number)) {
        $(".tishibuton-area .score-input").css({"display": "inline"});
      }
      layer.open({
        type:1,
        area:"450px",
        content:$('.tishibuton-area')
      });
  });

  var cookie = window.localStorage.getItem('sClientCookie'),
      userGid = window.localStorage.getItem('userGid');
  $("userGid").html(userGid);

  var temp_telphone = window.localStorage.getItem("temp_telphone")
  if(temp_telphone !== null && temp_telphone !== 'undefined') {
    $("#search").val(temp_telphone);
    $("#btn_search").click();
    window.localStorage.removeItem("temp_telphone")
  }
})
</script>

<script src="assets/javascripts/side.js?timestamp=1501089370"></script>
<script type="text/javascript">
  window.onload = function() {
    $('#jiaZai').hide();
    $('#main').show();
  }
  window.onresize = function() {
    console.log("width = " + window.innerWidth + ";height=" + window.innerHeight);
    $("#main").css({
      "background": "url('assets/images/bg-blur.jpg')",
      "filter": "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale')",
      "-moz-background-size": "100% 100%",
      "background-size": "100% 100%",
      "-webkit-animation": "fadeIn .6s backwards",
      "display": "block"
    });
  }

</script>
</body>
</html>
